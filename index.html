<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CigaTuan</title>
    <style>
        body { font-family: Arial, sans-serif; text-align: center; margin: 20px; }
        h1 { color: #007bff; display: flex; justify-content: center; align-items: center; cursor: pointer; position: relative; }
        h1 .arrow { margin-left: 5px; font-size: 14px; }
        .dropdown { display: none; position: absolute; top: 40px; background: white; box-shadow: 0px 4px 8px rgba(0,0,0,0.2); border-radius: 5px; padding: 10px; z-index: 10; }
        .dropdown a, .dropdown div { display: block; padding: 10px; text-decoration: none; color: black; cursor: pointer; }
        .dropdown a:hover, .dropdown div:hover { background: #f0f0f0; }
        .hidden { display: none; }
        .donate-box { padding: 10px; text-align: left; }
        .donate-box button { margin-top: 5px; padding: 5px 10px; cursor: pointer; background: #007bff; color: white; border: none; border-radius: 3px; }
    </style>
</head>
<body>

    <h1 onclick="toggleMenu()">CigaTuan <span class="arrow">‚ñº</span>
        <div class="dropdown" id="menu">
            <a href="https://www.facebook.com/tuan.nguyen.133171/" target="_blank">Facebook</a>
            <div onclick="toggleDonate()">Donate</div>
        </div>
    </h1>
    <h2>Ch·ªçn file CSV ƒë·ªÉ h·ªçc t·ª´ v·ª±ng</h2>

    <div class="hidden" id="donate-box">
        <h3>Th√¥ng tin Donate</h3>
        <p><b>Ng√¢n h√†ng:</b> BIDV</p>
        <p><b>Ch·ªß t√†i kho·∫£n:</b> Nguy·ªÖn Anh Tu·∫•n</p>
        <p><b>S·ªë t√†i kho·∫£n:</b> <span id="bank-account">6360362786</span>
            <button onclick="copyAccount()">üìã Sao ch√©p</button>
        </p>
    </div>

    <input type="file" id="csvFile" accept=".csv">
    <button onclick="loadCSV()">T·∫£i File</button>
    <button onclick="resetFile()">Ch·ªçn File Kh√°c</button>

    <div class="button-container">
        <button onclick="startLearning()" id="startButton" style="display: none;">B·∫Øt ƒë·∫ßu h·ªçc</button>
        <button onclick="restartLearning()" id="restartButton" style="display: none;">H·ªçc l·∫°i t·ª´ ƒë·∫ßu</button>
    </div>

    <div id="quiz-container">
        <p id="question"></p>
        <input type="text" id="answer" placeholder="Nh·∫≠p t·ª´ ti·∫øng Anh" autocomplete="off" />
        <button onclick="checkAnswer()">Ki·ªÉm tra</button>
        <p id="result"></p>
    </div>

    <script>
        let words = [];
        let currentIndex = 0;

        function loadCSV() {
            let fileInput = document.getElementById("csvFile");
            let file = fileInput.files[0];

            if (!file) {
                alert("Vui l√≤ng ch·ªçn m·ªôt file CSV!");
                return;
            }

            let reader = new FileReader();
            reader.readAsText(file);
            reader.onload = function(event) {
                let csvData = event.target.result;
                parseCSV(csvData);
            };
        }

        function parseCSV(data) {
            let rows = data.split("\n").map(row => row.split(","));
            
            // Gi·∫£ s·ª≠ c·ªôt 1 l√† Ti·∫øng Anh, c·ªôt 2 l√† Ti·∫øng Vi·ªát
            words = rows.slice(1).map(row => ({
                Vietnamese: row[1]?.trim(),
                English: row[0]?.trim()
            })).filter(word => word.Vietnamese && word.English);

            if (words.length > 0) {
                document.getElementById("startButton").style.display = "inline-block";
                document.getElementById("restartButton").style.display = "inline-block";
                alert("T·∫£i d·ªØ li·ªáu th√†nh c√¥ng! B·∫•m 'B·∫Øt ƒë·∫ßu h·ªçc' ƒë·ªÉ ti·∫øp t·ª•c.");
            } else {
                alert("L·ªói khi ƒë·ªçc file. Vui l√≤ng ki·ªÉm tra ƒë·ªãnh d·∫°ng CSV!");
            }
        }

        function startLearning() {
            document.getElementById("quiz-container").style.display = "block";
            currentIndex = 0;
            loadQuestion();
        }

        function restartLearning() {
            currentIndex = 0;
            loadQuestion();
        }

        function resetFile() {
            location.reload(); // T·∫£i l·∫°i trang ƒë·ªÉ ch·ªçn file kh√°c
        }

        function loadQuestion() {
            if (currentIndex < words.length) {
                document.getElementById("question").innerText = "Ti·∫øng Vi·ªát: " + words[currentIndex].Vietnamese;
                document.getElementById("answer").value = "";
                document.getElementById("result").innerText = "";
            } else {
                document.getElementById("quiz-container").innerHTML = "<h3>B·∫°n ƒë√£ ho√†n th√†nh b√†i h·ªçc!</h3>";
            }
        }

        function checkAnswer() {
            let userAnswer = document.getElementById("answer").value.trim();
            let correctAnswer = words[currentIndex].English;

            if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
                document.getElementById("result").innerText = "‚úÖ Ch√≠nh x√°c!";
            } else {
                document.getElementById("result").innerText = "‚ùå Sai! ƒê√°p √°n ƒë√∫ng: " + correctAnswer;
            }

            // Sau 1 gi√¢y t·ª± ƒë·ªông chuy·ªÉn sang t·ª´ ti·∫øp theo
            setTimeout(() => {
                currentIndex++;
                loadQuestion();
            }, 1000);
        }
        function toggleMenu() {
            let menu = document.getElementById("menu");
            menu.style.display = (menu.style.display === "block") ? "none" : "block";
        }

        function toggleDonate() {
            let donateBox = document.getElementById("donate-box");
            donateBox.classList.toggle("hidden");
        }

        function copyAccount() {
            let accountText = document.getElementById("bank-account").innerText;
            navigator.clipboard.writeText(accountText);
            alert("ƒê√£ sao ch√©p s·ªë t√†i kho·∫£n!");
        }
    </script>

</body>
</html>
